---
import Footer from "@/layout/Footer.astro";
import Header from "@/layout/Header.astro";
import RootLayout from "@/site/Root.astro";
import { SITE_NAME } from "@/site/meta";

export type Props = {
  content?: { title?: string; description?: string };
};

const { content = {} } = Astro.props;
const mainContentId = "spookysoftware-main-content";
const uriSite = encodeURIComponent(SITE_NAME);
const googleFontHref = `https://fonts.googleapis.com/css?family=Amatic+SC:700&text=${uriSite}&display=swap`;
const titlePrefix = content.title ? `${content.title} | ` : "";
const fullTitle = `${titlePrefix}${SITE_NAME}`;
---

<RootLayout content={{ ...content, title: fullTitle }}>
  <Fragment slot="head">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preload" as="style" href={googleFontHref} />
    <noscript>
      <link rel="stylesheet" href={googleFontHref} />
      <style is:inline>
        .font-cursive {
          visibility: visible !important;
        }
      </style>
    </noscript>
  </Fragment>

  <div class="flex flex-col mx-auto max-w-4xl">
    <a
      href={`#${mainContentId}`}
      class="absolute top-0 left-1/2 p-1 -translate-x-1/2 -translate-y-full opacity-0 transition focus:ease-in focus:translate-y-0 focus:opacity-100 motion-reduce:transition-none"
    >
      Jump to Content
    </a>
    <div class="px-5">
      <Header />
      <slot name="headsup"></slot>
      <main id={mainContentId} class="mb-20">
        <slot></slot>
      </main>
      <Footer />
    </div>
  </div>
  <script is:inline define:vars={{ googleFontHref }}>
    const link = document.createElement("link");
    link.media = "print";
    link.rel = "stylesheet";
    link.onload = function () {
      link.removeAttribute("media");
      document.body.classList.add("font-cursive-loaded");
    };
    link.href = googleFontHref;
    document.head.appendChild(link);
  </script>
</RootLayout>
